<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        input, button { padding: 10px; margin: 5px; }
    </style>
</head>
<body>
    <h1>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…</h1>
    
    <div class="test-section">
        <h3>1. Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª</h3>
        <button onclick="testFiles()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª</button>
        <div id="filesResult"></div>
    </div>
    
    <div class="test-section">
        <h3>2. Ø§Ø®ØªØ¨Ø§Ø± Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
        <button onclick="testDatabase()">Ø§Ø®ØªØ¨Ø§Ø± Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        <div id="dbResult"></div>
    </div>
    
    <div class="test-section">
        <h3>3. Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø­Ø«</h3>
        <input type="text" id="searchInput" placeholder="Ø§ÙƒØªØ¨ Ù„Ù„Ø¨Ø­Ø«...">
        <button onclick="testSearch()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø­Ø«</button>
        <div id="searchResult"></div>
    </div>

    <script type="module">
        import { searchProducts } from './local-search.js';
        
        window.testFiles = async function() {
            const result = document.getElementById('filesResult');
            result.innerHTML = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...';
            
            try {
                // Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª
                const files = ['app.js', 'local-search.js', 'products-db.json', 'style.css'];
                const results = [];
                
                for (const file of files) {
                    try {
                        const response = await fetch(file);
                        if (response.ok) {
                            results.push(`âœ… ${file} - Ù…ØªÙˆÙØ±`);
                        } else {
                            results.push(`âŒ ${file} - ØºÙŠØ± Ù…ØªÙˆÙØ± (${response.status})`);
                        }
                    } catch (error) {
                        results.push(`âŒ ${file} - Ø®Ø·Ø£: ${error.message}`);
                    }
                }
                
                result.innerHTML = results.join('<br>');
                result.className = 'test-section success';
                
            } catch (error) {
                result.innerHTML = `âŒ Ø®Ø·Ø£: ${error.message}`;
                result.className = 'test-section error';
            }
        };
        
        window.testDatabase = async function() {
            const result = document.getElementById('dbResult');
            result.innerHTML = 'Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...';
            
            try {
                const response = await fetch('./products-db.json');
                if (response.ok) {
                    const data = await response.json();
                    result.innerHTML = `âœ… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù…Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­<br>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${data.length}`;
                    result.className = 'test-section success';
                } else {
                    result.innerHTML = `âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (${response.status})`;
                    result.className = 'test-section error';
                }
            } catch (error) {
                result.innerHTML = `âŒ Ø®Ø·Ø£: ${error.message}`;
                result.className = 'test-section error';
            }
        };
        
        window.testSearch = async function() {
            const result = document.getElementById('searchResult');
            const query = document.getElementById('searchInput').value;
            
            if (!query) {
                result.innerHTML = 'âŒ ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ù†Øµ Ù„Ù„Ø¨Ø­Ø«';
                result.className = 'test-section error';
                return;
            }
            
            result.innerHTML = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...';
            
            try {
                // Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø¨Ø§Ø´Ø± Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹
                const dbResponse = await fetch('./products-db.json');
                if (!dbResponse.ok) {
                    result.innerHTML = `âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (${dbResponse.status})`;
                    result.className = 'test-section error';
                    return;
                }
                
                const dbData = await dbResponse.json();
                result.innerHTML = `ğŸ“Š Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ${dbData.length} Ù…Ù†ØªØ¬<br>`;
                
                // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø­Ø«
                const results = searchProducts(query);
                if (results.length > 0) {
                    const items = results.map(item => 
                        `${item.code} - ${item.name} (${item.price} Ø±ÙŠØ§Ù„)`
                    ).join('<br>');
                    result.innerHTML += `âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${results.length} Ù†ØªÙŠØ¬Ø©:<br>${items}`;
                    result.className = 'test-section success';
                } else {
                    result.innerHTML += `âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø¨Ø­Ø«: "${query}"`;
                    result.className = 'test-section error';
                }
            } catch (error) {
                result.innerHTML = `âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨Ø­Ø«: ${error.message}`;
                result.className = 'test-section error';
            }
        };
    </script>
</body>
</html> 